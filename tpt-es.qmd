---
title: "_Executive Summary_: Statistik Industri Tekstil dan Pakaian Jadi"
author: "Statistisi di Statistik Industri Besar dan Sedang, BPS"
date: "`r format(Sys.Date(), '%d %m %Y')`"
date-format: iso

format: html
execute:
  echo: false
  warning: false
  message: false
toc: true
editor: visual
---

```{css}
p {
  text-align: justify
}
```

```{r, warning=FALSE}
# Package
library(readxl)
library(dplyr)
library(tidyverse)

### Visualization----------------------------------------------------------
library(ggplot2)
library(ggthemes)
library(scales)
library(sf)
library(plotly)
```

```{r}
# Load data economic indicators
tpt_combine <- read_xlsx("D:/##AYUPA DESKTOP 2/TPT/tpt_combine.xlsx")
tpt1721     <- read_xlsx("D:/##AYUPA DESKTOP 2/TPT/tp1721.xlsx")

# Load data number establishments
tpt_combine_est <- read_xlsx("D:/##AYUPA DESKTOP 2/TPT/tpt_combine_est.xlsx")
```

## Pendahuluan

Industri tekstil dan produk tekstil (TPT) merupakan salah satu sektor unggulan dalam perekonomian Indonesia. Sektor ini tidak hanya menjadi tulang punggung ekspor non-migas, tetapi juga berperan penting dalam penyerapan tenaga kerja dan pertumbuhan industri dalam negeri, di mana industri TPT menyumbang sekitar 4,88 persen terhadap kinerja industri manufaktur nasional. Sebagai negara dengan populasi yang besar dan tenaga kerja yang kompetitif, Indonesia memiliki potensi besar untuk terus mengembangkan industri TPT.

Dalam beberapa tahun terakhir, industri TPT Indonesia telah mengalami dinamika tantangan baik lokal maupun global, khususnya di sisi produksi, tenaga kerja, hingga bahan baku. Oleh karena itu, analisis deskriptif tren industri TPT sangat penting untuk memahami kondisi industri ini dalam beberapa tahun terakhir.

Dalam *executive summary* ini, kami akan menyajikan gambaran umum mengenai performa industri TPT Indonesia, meliputi data jumlah perusahaan, tenaga kerja, output dan strukturnya, input dan strukturnya, serta isu-isu terkait yang mempengaruhi sektor ini. Harapannya, informasi ini dapat menjadi acuan bagi para pemangku kepentingan dalam mengambil keputusan strategis untuk meningkatkan daya saing dan keberlanjutan industri TPT di Indonesia.

::: {.callout-caution appearance="simple"}
## *Disclaimer*:

-   Industri tekstil dan produk tekstil (TPT) mencakup kategori C (Industri Pengolahan) golongan pokok 13 **industri tekstil** dan golongan pokok 14 **industri pakaian jadi** dalam Klasifikasi Baku Lapangan Usaha Indonesia (KBLI).
-   Sumber data yang digunakan merupakan gabungan dari hasil *Updating* Direktori (DPA) dan Survei Tahunan Perusahaan Industri Manufaktur (STPIM) yang dilakukan setiap tahun. Target responden survei adalah perusahaan **berskala besar dan sedang**.
-   Klasifikasi usaha berdasarkan tenaga kerja: usaha dengan jumlah tenaga kerja 20-99 orang diklasifikasikan sebagai skala besar, sedangkan usaha dengan jumlah tenaga kerja lebih dari 99 orang diklasifikasikan sebagai skala sedang.
-   Publikasi lengkap dapat dilihat di [**www.bps.go.id**](www.bps.go.id)
:::

## Jumlah perusahaan

```{r, warning=FALSE}
### No. establishment----------------------------------------------------------
# Each Categori label shown
total_est <- tpt_combine_est %>%
  group_by(year, name_isic2, isic2) %>%
  summarise(total = n())       

n13_2023 <- format(total_est$total[total_est$year == 2023 & total_est$isic2 == 13], big.mark = ".")

n13_2021 <- format(total_est$total[total_est$year == 2021 & total_est$isic2 == 13], big.mark = ".")

n14_2023 <- format(total_est$total[total_est$year == 2023 & total_est$isic2 == 14], big.mark = ".")

n14_2021 <- format(total_est$total[total_est$year == 2021 & total_est$isic2 == 14], big.mark = ".")

```

Jumlah perusahaan dalam industri Tekstil, Pakaian, dan Tekstil (TPT) mengalami penurunan tren sepanjang 2016-2021. Namun, pada tahun 2023, terdapat sedikit peningkatan jumlah perusahaan *industri tekstil* dibandingkan dengan dua tahun sebelumnya. Pada tahun 2023, jumlah perusahaan industri tekstil mencapai *`r n13_2023`* perusahaan, naik dari `r n13_2021` perusahaan pada tahun 2021. Sementara itu, jumlah perusahaan *industri pakaian jadi* juga sedikit meningkat, `r n14_2021` perusahaan pada tahun 2021 menjadi *`r n14_2023`* perusahaan pada tahun 2023.

```{r, warning=FALSE}

ggplot(total_est, aes(x = factor(year), y = total, fill = factor(name_isic2))) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)(total), 
                y = total, group = name_isic2),
            position = position_stack(vjust = 0.5), color = "white") +  # Add labels for the sum of labor
  labs(title = "Jumlah Perusahaan",
       x = "",
       y = "",
       fill = "Industri",
       caption = "Sumber: Sensus Ekonomi (2016), STPIM (2017-2021), Updating DPA (2022-2023)") +
  theme_pander() +
  scale_fill_economist() +
  scale_y_continuous(labels = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)) 


```


## Tenaga kerja

```{r, warning=FALSE}
### Labor----------------------------------------------------------
# Each Categori label shown
total_labor <- tpt_combine %>%
  group_by(year, name_isic2, isic2) %>%
  summarise(total = sum(labor)) 

labor13_2021 <- format(total_labor$total[total_labor$year == 2021 & total_labor$isic2 == 13], big.mark = ".")

labor14_2021 <- format(total_labor$total[total_labor$year == 2021 & total_labor$isic2 == 14], big.mark = ".")

```

Tren tenaga kerja di industri TPT cenderung mengalami penurunan beberapa tahun ke belakang. Pada tahun 2021, industri tekstil menyerap *`r labor13_2021`* tenaga kerja. Sementara tenaga kerja pada industri pakaian jadi mencapai *`r labor14_2021`* orang pada periode yang sama.

```{r, warning=FALSE}

ggplot(total_labor, aes(x = factor(year), y = total, fill = factor(name_isic2))) +
         geom_bar(stat = "identity", position = "stack") +
         geom_text(aes(label = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)(total), 
                       y = total, group = name_isic2),
                   position = position_stack(vjust = 0.5), color = "white") +  # Add labels for the sum of labor
         labs(title = "Total Tenaga Kerja",
              x = "",
              y = "",
              fill = "Industri",
              caption = "Sumber: Sensus Ekonomi (2016), STPIM (2017-2021)") +
         theme_pander() +
         scale_fill_economist() +
         scale_y_continuous(labels = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)) 

```

## Output

```{r, warning=FALSE}
### Output----------------------------------------------------------
# Each Categori label shown
total_output <- tpt_combine %>%
  group_by(year, name_isic2, isic2) %>%
  summarise(total = round(sum(total_output)/1e+6),)        # per billion

output1314_2021 <- format(total_output$total[total_output$year == 2021 & total_output$isic2 == 13] + total_output$total[total_output$year == 2021 & total_output$isic2 == 14], big.mark = ".")

output1314_2019 <- format(total_output$total[total_output$year == 2019 & total_output$isic2 == 13] + total_output$total[total_output$year == 2019 & total_output$isic2 == 14], big.mark = ".")

```

Output industri TPT berfluktuaktif sepanjang 2016-2021. Pada tahun 2019, sebelum pandemi Covid-19, industri TPT menghasilkan output tertinggi dalam 6 tahun terakhir, di mana nilainya mencapai *`r output1314_2019`* miliar Rupiah. Pada periode selanjutnya, kinerja industri TPT terindikasi mengalami pelemahan yang terlihat dari penurunan output menjadi *`r output1314_2021`* miliar Rupiah pada 2021.

```{r, warning=FALSE}

ggplot(total_output, aes(x = factor(year), y = total, fill = factor(name_isic2))) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)(total), 
                y = total, group = name_isic2),
            position = position_stack(vjust = 0.5), color = "white") +  # Add labels for the sum of labor
  labs(title = "Total Output",
       x = "",
       y = "miliar Rupiah",
       fill = "Industri",
       caption = "Sumber: Sensus Ekonomi (2016), STPIM (2017-2021)") +
  theme_pander() +
  scale_fill_economist() +
  scale_y_continuous(labels = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)) 

```

### Struktur output industri tekstil

```{r, warning=FALSE}
### Output structure (prod_goods, prod_serv & oth) ----------------------------------------------------------
# Each Categori label shown
total_outputstr <- tpt1721 %>%
  group_by(year, name_isic2) %>%
  summarise(total_prodgoods = round(sum(prod_goods)/1e+6),     # per billion
            total_prodserv = round(sum(prod_serv)/1e+6),     # per billion
            total_outp = round(sum(total_output)/1e+6),
            total_outputoth = total_outp - (total_prodgoods + total_prodserv))    # per billion

# Reshape  
total_outputstr1 <- reshape2::melt(total_outputstr, id.vars = c("year", "name_isic2"))
# Filter ISIC2 = 13
total_outputstr1_13 <- total_outputstr1 %>%
  filter(name_isic2 == "Tekstil") %>%
  filter(variable != "total_outp") %>%
  mutate(variable = case_when(
    variable == "total_prodgoods" ~ "Produksi barang",
    variable == "total_prodserv" ~ "Maklun/jasa",
    variable == "total_outputoth" ~ "Lainnya",
    TRUE ~ variable
  ))
total_outputstr1_13$variable <- factor(total_outputstr1_13$variable, levels = c("Produksi barang", "Maklun/jasa", "Lainnya"))


# Filter ISIC2 =14
total_outputstr1_14 <- total_outputstr1 %>%
  filter(name_isic2 == "Pakaian Jadi") %>%
  filter(variable != "total_outp") %>%
  mutate(variable = case_when(
  variable == "total_prodgoods" ~ "Produksi barang",
  variable == "total_prodserv" ~ "Maklun/jasa",
  variable == "total_outputoth" ~ "Lainnya",
  TRUE ~ variable
))
total_outputstr1_14$variable <- factor(total_outputstr1_14$variable, levels = c("Produksi barang", "Maklun/jasa", "Lainnya"))


prod13_2021 <- format(total_outputstr1_13$value[total_outputstr1_13$year == 2021 & total_outputstr1_13$variable == 'Produksi barang'], big.mark = ".")

serv13_2021 <- format(total_outputstr1_13$value[total_outputstr1_13$year == 2021 & total_outputstr1_13$variable == 'Maklun/jasa'], big.mark = ".")

othout13_2021 <- format(total_outputstr1_13$value[total_outputstr1_13$year == 2021 & total_outputstr1_13$variable == 'Lainnya'], big.mark = ".")

prod14_2021 <- format(total_outputstr1_14$value[total_outputstr1_14$year == 2021 & total_outputstr1_14$variable == 'Produksi barang'], big.mark = ".")

serv14_2021 <- format(total_outputstr1_14$value[total_outputstr1_14$year == 2021 & total_outputstr1_14$variable == 'Maklun/jasa'], big.mark = ".")

othout14_2021 <- format(total_outputstr1_14$value[total_outputstr1_14$year == 2021 & total_outputstr1_14$variable == 'Lainnya'], big.mark = ".")

prod14_2017 <- format(total_outputstr1_14$value[total_outputstr1_14$year == 2017 & total_outputstr1_14$variable == 'Produksi barang'], big.mark = ".")

serv14_2017 <- format(total_outputstr1_14$value[total_outputstr1_14$year == 2017 & total_outputstr1_14$variable == 'Maklun/jasa'], big.mark = ".")


```

Struktur output **industri tekstil** rata-rata didominasi oleh nilai produksi barang. Pada tahun 2021, *nilai produksi barang tekstil* mencapai *`r prod13_2021`* miliar Rupiah. Sementara, proporsi terkecil dalam output indsutri tekstil adalah *nilai maklun/jasa* yang nilainya sebesar *`r serv13_2021`* miliar Rupiah. Sisanya, *`r othout13_2021`* miliar Rupiah berasal dari *pendapatan lainnya*.

```{r, warning=FALSE}

# Struktur Output Tekstil
ggplot(total_outputstr1_13, aes(x = year, y = value, fill = variable)) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)(value), 
                y = value),
            position = position_stack(vjust = 0.5), color = "white", size = 3) +  # Add labels for the sum of labor
  labs(title = "Struktur Output Industri Tekstil",
       x = "",
       y = "miliar Rupiah",
       fill = "",
       caption = "Sumber: STPIM (2017-2021)") +
  theme_pander() +
  scale_fill_economist() +
  scale_y_continuous(labels = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)) 

```

Pada **industri pakaian jadi**, perubahan struktur output terlihat pada grafik di bawah. Pada tahun 2017, komposisi output industri pakaian jadi didominasi oleh nilai maklun/jasa, di mana nilainya, `r serv14_2017` sedikit lebih besar dibandingkan nilai produksi barang, `r prod14_2017`. Pada periode selanjutnya, tercatat nilai produksi barang berkontribusi signifikan dalam struktur output industri pakaian jadi. *Nilai produksi pakaian jadi* mencapai *`r prod14_2021`* pada tahun 2021, sementara *nilai maklun/jasa* tercatat sebesar *`r serv14_2021`* dan *pendapatan lain* sebesar *`r othout14_2021`*.

### Struktur output industri pakaian jadi

```{r, warning=FALSE}
# Struktur Output Pakaian Jadi
ggplot(total_outputstr1_14, aes(x = year, y = value, fill = variable)) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)(value), 
                y = value),
            position = position_stack(vjust = 0.5), color = "white", size = 3) +  # Add labels for the sum of labor
  labs(title = "Struktur Output Industri Pakaian Jadi",
       x = "",
       y = "miliar Rupiah",
       fill = "",
       caption = "Sumber: STPIM (2017-2021)") +
  theme_pander() +
  scale_fill_economist() +
  scale_y_continuous(labels = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)) 

```

## Input

::: {.callout-note appearance="simple"}
## Catatan:

Input meliputi pengeluaran upah untuk tenaga kerja, bahan baku lokal dan impor, serta pengeluaran untuk input lainnya yang dikeluarkan oleh perusahaan.
:::

```{r, warning=FALSE}
### Input ----------------------------------------------------------
# Each Categori label shown
total_input <- tpt_combine %>%
  group_by(year, name_isic2, isic2) %>%
  summarise(total = round(sum(total_input)/1e+6),)        # per billion

input1314_2019 <- format(total_input$total[total_input$year == 2019 & total_input$isic2 == 13] + total_input$total[total_input$year == 2019 & total_input$isic2 == 14], big.mark = ".")

input13_2021 <- format(total_input$total[total_input$year == 2021 & total_input$isic2 == 13], big.mark = ".")

input14_2021 <- format(total_input$total[total_input$year == 2021 & total_input$isic2 == 14], big.mark = ".")

```

Total pengeluaran untuk input produksi industri TPT berfluktuasi sepanjang 2016-2021. Total pengeluaran input industri TPT tertinggi terjadi pada tahun 2019, di mana nilainya mencapai *`r input1314_2019`* miliar Rupiah. Pada tahun 2021, nilai input pada *industri tekstil* mengalami penurunan dibandingkan beberapa tahun sebelumnya menjadi *`r input13_2021`* miliar Rupiah. Sebaliknya, nilai input *industri pakaian jadi* meningkat menjadi *`r input14_2021`* miliar Rupiah di tahun 2021.

```{r, warning=FALSE}

ggplot(total_input, aes(x = factor(year), y = total, fill = factor(name_isic2))) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)(total), 
                y = total, group = name_isic2),
            position = position_stack(vjust = 0.5), color = "white") +  # Add labels for the sum of labor
  labs(title = "Total Input",
       x = "",
       y = "miliar Rupiah",
       fill = "Industri",
       caption = "Sumber: Sensus Ekonomi (2016), STPIM (2017-2021)") +
  theme_pander() +
  scale_fill_economist() +
  scale_y_continuous(labels = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)) 

```

### Struktur input industri tekstil

```{r, warning=FALSE}
### Input structure (wage_prod, wage_othr, raw_material_dom, raw_material_imp, & oth) ----------------------------------------------------------
# Each Categori label shown
total_inputstr <- tpt1721 %>%
  group_by(year, name_isic2) %>%
  summarise(total_wage = round(sum(wage_prod)/1e+6) + round(sum(wage_othr)/1e+6),        # per billion
            total_rawdom = round(sum(raw_material_dom)/1e+6),   # per billion
            total_rawimp = round(sum(raw_material_imp)/1e+6),   # per billion
            total_inp = round(sum(total_input)/1e+6),           # per billion
            total_inputoth = total_inp - (total_rawdom + total_rawimp))    # per billion

# Reshape  
total_inputstr1 <- reshape2::melt(total_inputstr, id.vars = c("year", "name_isic2"))

# Filter ISIC2 = 13
total_inputstr1_13 <- total_inputstr1 %>%
  filter(name_isic2 == "Tekstil") %>%
  filter(variable != "total_inp") %>%
  mutate(variable = case_when(
    variable == "total_wage" ~ "Upah pekerja",
    variable == "total_rawdom"   ~ "Bahan baku lokal",
    variable == "total_rawimp"   ~ "Bahan baku impor",
    variable == "total_inputoth"   ~ "Input lainnya",
    TRUE ~ variable
  ))
total_inputstr1_13$variable <- factor(total_inputstr1_13$variable, levels = c("Upah pekerja", "Bahan baku lokal", 
                                                                              "Bahan baku impor", "Input lainnya"))


# Filter ISIC2 =14
total_inputstr1_14 <- total_inputstr1 %>%
  filter(name_isic2 == "Pakaian Jadi") %>%
  filter(variable != "total_inp") %>%
  mutate(variable = case_when(
    variable == "total_wage"     ~ "Upah pekerja",
    variable == "total_rawdom"   ~ "Bahan baku lokal",
    variable == "total_rawimp"   ~ "Bahan baku impor",
    variable == "total_inputoth"   ~ "Input lainnya",
    TRUE ~ variable
  ))
total_inputstr1_14$variable <- factor(total_inputstr1_14$variable, levels = c("Upah pekerja", "Bahan baku lokal", 
                                                                              "Bahan baku impor", "Input lainnya"))


bbdom13_2021 <- format(total_inputstr1_13$value[total_inputstr1_13$year == 2021 & total_inputstr1_13$variable == 'Bahan baku lokal'], big.mark = ".")

bbimp13_2021 <- format(total_inputstr1_13$value[total_inputstr1_13$year == 2021 & total_inputstr1_13$variable == 'Bahan baku impor'], big.mark = ".")

bbdom14_2021 <- format(total_inputstr1_14$value[total_inputstr1_14$year == 2021 & total_inputstr1_14$variable == 'Bahan baku lokal'], big.mark = ".")

bbimp14_2021 <- format(total_inputstr1_14$value[total_inputstr1_14$year == 2021 & total_inputstr1_14$variable == 'Bahan baku impor'], big.mark = ".")

bbimp14_2017 <- format(total_inputstr1_14$value[total_inputstr1_14$year == 2017 & total_inputstr1_14$variable == 'Bahan baku impor'], big.mark = ".")

```

```{r, warning=FALSE}
### Proporsi upah dan input tekstil

### Proporsi Upah dan Input ----------------------------------------------------------
input21_prop_13 <- total_inputstr1[total_inputstr1$year == 2021 
                                   & total_inputstr1$name_isic2 == "Tekstil", ]

# Calculate prop
input21_prop_13$prop <- NA  
# Find indices of relevant variables
compo_index <- which(input21_prop_13$variable %in% c("total_wage", "total_rawdom", "total_rawimp", "total_inputoth"))
total_index <- which(input21_prop_13$variable == "total_inp")

# Calculate prop for relevant rows
input21_prop_13$prop[compo_index] <- round((input21_prop_13$value[compo_index] / (input21_prop_13$value[total_index] + input21_prop_13$value[which(input21_prop_13$variable == "total_wage")]) * 100), 2)

# Change legend
input21_prop_13$variable <- ifelse(input21_prop_13$variable == "total_wage", "Upah pekerja",
                                   ifelse(input21_prop_13$variable == "total_rawdom", "Bahan baku lokal",
                                          ifelse(input21_prop_13$variable == "total_rawimp", "Bahan baku impor",
                                                 ifelse(input21_prop_13$variable == "total_inputoth", "Input lainnya",
                                                        ifelse(input21_prop_13$variable == "total_inp", "Total input",
                                                               input21_prop_13$variable)))))

order_inputcompo <- c("Upah pekerja", "Bahan baku lokal", "Bahan baku impor", "Input lainnya")
input21_prop_13$variable <- factor(input21_prop_13$variable, levels = order_inputcompo)  #Reorder custom label


pbbdom13_2021 <- format(input21_prop_13$prop[input21_prop_13$variable == 'Bahan baku lokal' & !is.na(input21_prop_13$prop)], big.mark = ",")

pbbimp13_2021 <- format(input21_prop_13$prop[input21_prop_13$variable == 'Bahan baku impor' & !is.na(input21_prop_13$prop)], big.mark = ",")

```

Struktur input industri tekstil rata-rata didominasi oleh pengeluaran untuk bahan baku. Sepanjang 2017-2021, tidak ada indikasi bahwa bahan baku impor mendominasi struktur input industri tekstil. Sebaliknya, bahan baku lokal memiliki kontribusi yang lebih besar dibandingkan bahan baku impor di dalam komposisi input industri ini. Pada tahun 2021, nilai pengeluaran untuk bahan baku lokal mencapai *`r pbbdom13_2021`* persen dari total nilai input atau sebesar *`r bbdom13_2021`* miliar Rupiah. Sementara, pengeluaran bahan baku impor sebesar *`r pbbimp13_2021`* persen atau *`r bbimp13_2021`* miliar Rupiah.

```{r, warning=FALSE}
# Struktur Input Tekstil
ggplot(total_inputstr1_13, aes(x = year, y = value, fill = variable)) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)(value), 
                y = value),
            position = position_stack(vjust = 0.5), color = "white") +  # Add labels for the sum of labor
  labs(title = "Struktur Input Industri Tekstil",
       x = "",
       y = "miliar Rupiah",
       fill = "",
       caption = "Sumber: STPIM (2017-2021)") +
  theme_pander() +
  scale_fill_economist() +
  scale_y_continuous(labels = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)) 

```

```{r, warning=FALSE}
### ### Proporsi upah dan input tekstil ----------------------------------------------------------

# Create a pie chart 
ggplot(input21_prop_13, aes(x = "", y = prop, fill = variable)) +
  geom_col() +
  geom_text(aes(label = paste0(prop, "%")),
            position = position_stack(vjust = 0.6),
            col = "white") +
  coord_polar(theta = "y", direction = -1) + 
  scale_fill_economist() +
  theme_void() +
  theme(plot.title = element_text(size = 13),  
        legend.position = "bottom",           
        legend.box = "horizontal") +
  labs(title = "Proporsi Struktur Input Industri Tekstil",
       fill = "",
       caption = "Sumber: STPIM 2021") 

```

### Struktur input industri pakaian jadi

```{r, warning=FALSE}
### Proporsi upah dan input pakaian jadi

### Proporsi Upah dan Input ----------------------------------------------------------
input21_prop_14 <- total_inputstr1[total_inputstr1$year == 2021 
                                   & total_inputstr1$name_isic2 == "Pakaian Jadi", ]

# Calculate prop
input21_prop_14$prop <- NA  
# Find indices of relevant variables
compo_index <- which(input21_prop_14$variable %in% c("total_wage", "total_rawdom", "total_rawimp", "total_inputoth"))
total_index <- which(input21_prop_14$variable == "total_inp")

# Calculate prop for relevant rows
input21_prop_14$prop[compo_index] <- round((input21_prop_14$value[compo_index] / (input21_prop_14$value[total_index] + input21_prop_14$value[which(input21_prop_14$variable == "total_wage")]) * 100), 2)

# Change legend
input21_prop_14$variable <- ifelse(input21_prop_14$variable == "total_wage", "Upah pekerja",
                                   ifelse(input21_prop_14$variable == "total_rawdom", "Bahan baku lokal",
                                          ifelse(input21_prop_14$variable == "total_rawimp", "Bahan baku impor",
                                                 ifelse(input21_prop_14$variable == "total_inputoth", "Input lainnya",
                                                        ifelse(input21_prop_14$variable == "total_inp", "Total input",
                                                               input21_prop_14$variable)))))

order_inputcompo <- c("Upah pekerja", "Bahan baku lokal", "Bahan baku impor", "Input lainnya")
input21_prop_14$variable <- factor(input21_prop_14$variable, levels = order_inputcompo)  #Reorder custom label


pbbdom14_2021 <- format(input21_prop_14$prop[input21_prop_14$variable == 'Bahan baku lokal' & !is.na(input21_prop_14$prop)], big.mark = ",")

pbbimp14_2021 <- format(input21_prop_14$prop[input21_prop_14$variable == 'Bahan baku impor' & !is.na(input21_prop_14$prop)], big.mark = ",")

```

Perubahan komposisi input **industri pakaian jadi** cukup dinamis sepanjang 2017-2021. Pelemahan kinerja industri tekstil dalam beberapa tahun terakhir disinyalir berpengaruh terhadap pasokan bahan baku lokal pada industri lanjutannya, yaitu industri pakaian jadi. Nilai pengeluaran untuk bahan baku impor meningkat tajam dari *`r bbimp14_2017`* miliar Rupiah pada tahun 2017 menjadi *`r bbimp14_2021`* miliar Rupiah pada tahun 2021 atau *`r pbbimp14_2021`* persen dari total nilai input industri pakaian jadi. Sementara itu, pengeluaran bahan baku lokal hanya berkontribusi *`r pbbdom14_2021`* persen atau sebesar *`r bbdom14_2021`* miliar Rupiah.

```{r, warning=FALSE}
# Struktur Output Pakaian Jadi
ggplot(total_inputstr1_14, aes(x = year, y = value, fill = variable)) +
  geom_bar(stat = "identity", position = "stack") +
  geom_text(aes(label = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)(value), 
                y = value),
            position = position_stack(vjust = 0.5), color = "white") +  # Add labels for the sum of labor
  labs(title = "Struktur Input Industri Pakaian Jadi",
       x = "",
       y = "miliar Rupiah",
       fill = "",
       caption = "Sumber: STPIM (2017-2021)") +
  theme_pander() +
  scale_fill_economist() +
  scale_y_continuous(labels = scales::number_format(scale = 1e-3, big.mark = ".", accuracy = 0.001)) 

```

```{r, warning=FALSE}
### ### Proporsi upah dan input tekstil ----------------------------------------------------------

# Create a pie chart 
ggplot(input21_prop_14, aes(x = "", y = prop, fill = variable)) +
  geom_col() +
  geom_text(aes(label = paste0(prop, "%")),
            position = position_stack(vjust = 0.6),
            col = "white") +
  coord_polar(theta = "y", direction = -1) + 
  scale_fill_economist() +
  theme_void() +
  theme(plot.title = element_text(size = 13),  
        legend.position = "bottom",           
        legend.box = "horizontal") +
  labs(title = "Proporsi Struktur Input Industri Pakaian Jadi",
       fill = "",
       caption = "Sumber: STPIM 2021") 

```

```{r, warning=FALSE}
#TAMBAHKAN ANALISIS TERKAIT DAMPAK COVID!!! >> Tenaga Kerja 


```
